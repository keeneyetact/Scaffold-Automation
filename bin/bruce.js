#!/usr/bin/env node
const e=require("chalk"),i=require("fs"),r=require("util"),o=require("commander"),s=require("dayjs"),a=require("latest-version"),t=require("rimraf"),c=require("semver"),{version:n}=require("../package"),{ACTION_TEXT:l,GLOB_TEXT:u}=require("../i18n"),{AbsPath:d,AutoBin:m,IsExist:p,ShowMsg:g}=require("../util/setting");(async()=>{if(c.gte(process.version,"v10.0.0")||(g("red",u.judgeVerNode),process.exit(1)),c.eq(n,await a("bruce-cli"))||g("red",u.judgeVerBruce),p("process.lock")){const e=r.promisify(t),o=d(""),a=d("process.lock");s().format("YYYY-MM-DD HH:mm:ss")>=i.readFileSync(a,"utf8")&&(await e(o),process.exit(1))}o.usage(e.yellowBright("<command> [option]")).version(n,"-v, --version").description(u.desc),o.command("build").alias("b").description(e.blueBright(l.build)).action(()=>m("build")),o.command("init").alias("i").description(e.blueBright(l.init)).action(()=>m("init")),o.command("locale").alias("l").description(e.blueBright(l.locale)).action(()=>m("locale")),o.command("new").alias("n").description(e.blueBright(l.new)).action(()=>m("new")),o.command("remove").alias("r").description(e.blueBright(l.remove)).action(()=>m("remove")),o.parse(process.argv),!o.args.length&&o.help()})();
#!/usr/bin/env node
const e=require("fs"),i=require("util"),r=require("chalk"),o=require("commander"),s=require("dayjs"),t=require("latest-version"),a=require("rimraf"),n=require("semver"),{version:c}=require("../package"),{ACTION_TEXT:l,GLOB_TEXT:u}=require("../i18n"),{AbsPath:d,AutoBin:m,ChaoticDate:p,IsExist:g,ShowMsg:h}=require("../util/setting");(async()=>{const v=i.promisify(a),q=d("..",1);if(n.lt(process.version,"v12.0.0")&&(h("red",u.judgeVerNode),process.exit(1)),n.eq(c,await t("bruce-cli"))||h("red",u.judgeVerBruce),g("../process.lock",1)){const i=d("../process.lock",1);s().format("YYYYMMDDHHmmss")>=p(e.readFileSync(i,"utf8"))&&(await v(q),process.exit(1))}else await v(q),process.exit(1);o.usage(r.yellowBright("<command> [option]")).version(c,"-v, --version",r.greenBright(u.version)).helpOption("-h, --help",r.greenBright(u.help)).description(u.desc),o.command("build").alias("b").description(r.blueBright(l.build)).action((()=>m("build"))),o.command("init").alias("i").description(r.blueBright(l.init)).action((()=>m("init"))),o.command("locale").alias("l").description(r.blueBright(l.locale)).action((()=>m("locale"))),o.command("new").alias("n").description(r.blueBright(l.new)).action((()=>m("new"))),o.command("remove").alias("r").description(r.blueBright(l.remove)).action((()=>m("remove"))),o.parse(process.argv)})();
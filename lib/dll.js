const e=require("fs"),r=require("chalk"),d=require("inquirer"),{DLL_TEXT:i}=require("../i18n"),{DEPENDENCE:o,AbsPath:t,BuildCb:l,IsExist:s,ShowMsg:n,ShowTitle:a}=require("../util");module.exports=async function(){if(a("dll"),!s("package.json"))return n("red",i.judgePackage);if(!s("node_modules"))return n("red",i.judgeModules);if(!s("src"))return n("red",i.judgeSrc);const u=["@babel/polyfill","@hot-loader/react-dom","lodash","lodash-es","react-hot-loader"],c=[{choices:Object.keys(o).sort().reduce((e,r)=>(!u.includes(r)&&e.push(r),e),[]),message:i.qaVendor,name:"vendor",type:"checkbox",validate:e=>!!e.length||r.redBright(i.judgeVendor)}],g=(await d.prompt(c)).vendor,h=require("../config/webpack.dll"),[f,p]=await l(h(g));if(f||!p)n("red",i.dllFail);else{const r=t("dist/static/vendor.json"),d=JSON.stringify({vendor:g},null,"\t");e.writeFileSync(r,d,"utf8"),n("green",i.dllSucceed)}};